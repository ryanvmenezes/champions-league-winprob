---
title: "R Notebook"
output: html_notebook
---

```{r}
library(locfit)
library(tidyverse)
```

```{r}
matrix  = read_csv('minute-matrix.csv')
```

```{r}
head(matrix)
```

```{r}
tail(matrix)
```

```{r}
model.simple = locfit(t1win ~ made_minute + t1goaldiff + t1awaygoaldiff, data = matrix, family = 'binomial')
```


```{r}
model.odds = locfit(t1win ~ made_minute + t1goaldiff + t1awaygoaldiff +
                      homewing1 + awaywing1 + homewing2 + awaywing2,
                    data = matrix,
                    family = 'binomial')
```

```{r}
matrix = matrix %>% 
  mutate(
    winprob = predict(model.simple, newdata = ., type = "response")
  )
```


```{r}
y = 2019
r = 'first'
t = 'united-psg'

matrix %>% 
  filter(season == y) %>% 
  filter(round == r) %>% 
  filter(tie == t) %>% 
  ggplot(aes(made_minute, winprob)) +
  geom_line() +
  scale_y_continuous(limits = c(0,1)) +
  theme_minimal() +
  xlab("Minutes left") +
  ylab("Win probability")
```

