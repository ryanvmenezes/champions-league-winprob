library(tidyverse)
matrix = read_csv('minute-matrix.csv')
matrix %>%
select(t1goal_diff, t1awaygoal_diff, t1win)
matrix %>%
select(made_minute, t1goal_diff, t1awaygoal_diff, t1win)
data =matrix %>%
select(made_minute, t1goal_diff, t1awaygoal_diff, t1win)
data = matrix %>%
select(made_minute, t1goal_diff, t1awaygoal_diff, t1win)
model = glm(t1win ~ made_minute + t1goal_diff + t1awaygoal_diff, family = "binomial", data = data)
model = glm(t1win ~ made_minute + t1goal_diff + t1awaygoal_diff, family = "binomial", data = matrix)
model = glm(t1win ~ made_minute + t1goal_diff + t1awaygoal_diff, family = "binomial", data = matrix)
matrix$pred_prob = model$fitted.values
View(matrix)
write_csv(matrix = 'pred-prob-log-reg.csv')
write_csv(matrix, 'pred-prob-log-reg.csv')
library(locfit)
library(tidyverse)
matrix  = read_csv('minute-matrix.csv')
head(matrix)
tail(matrix)
model.simple = locfit(t1win ~ made_minute + t1goaldiff + t1awaygoaldiff, data = matrix, family = 'binomial')
matrix = matrix %>%
mutate(
winprob = predict(model.simple, newdata = ., type = "response")
)
y = 2019
r = 'first'
t = 'united-psg'
matrix %>%
filter(season == y) %>%
filter(round == r) %>%
filter(tie == t) %>%
ggplot(aes(made_minute, winprob)) +
geom_line() +
scale_y_continuous(limits = c(0,1)) +
theme_minimal() +
xlab("Minutes left") +
ylab("Win probability")
